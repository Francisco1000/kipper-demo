<configuration>
<firewall>
  <family>
    <inet>
      <filter operation="replace">
        <name>RE_PROTECT</name>
        <term>
          <name>SSH</name>
          <from>
            <source-prefix-list>
              <name>TRUSTED</name>
            </source-prefix-list>
            <protocol>tcp</protocol>
            <port>ssh</port>
          </from>
          <then>
            <accept/>
          </then>
        </term>
        <term>
          <name>NETCONF</name>
          <from>
            <source-prefix-list>
              <name>TRUSTED</name>
            </source-prefix-list>
            <protocol>tcp</protocol>
            <destination-port>830</destination-port>
          </from>
          <then>
            <accept/>
          </then>
        </term>
        <term>
          <name>BGP</name>
          <from>
            <source-prefix-list>
              <name>BGP_PEERS</name>
            </source-prefix-list>
            <protocol>tcp</protocol>
            <port>bgp</port>
          </from>
          <then>
            <accept/>
          </then>
        </term>
        <term>
          <name>DNS</name>
          <from>
            <source-prefix-list>
              <name>DNS_SERVERS</name>
            </source-prefix-list>
            <protocol>udp</protocol>
            <protocol>tcp</protocol>
            <port>domain</port>
          </from>
          <then>
            <accept/>
          </then>
        </term>
        <term>
          <name>ICMP</name>
          <from>
            <protocol>icmp</protocol>
            <icmp-type>echo-request</icmp-type>
            <icmp-type>echo-reply</icmp-type>
            <icmp-type>unreachable</icmp-type>
            <icmp-type>time-exceeded</icmp-type>
            <icmp-type>source-quench</icmp-type>
          </from>
          <then>
            <accept/>
          </then>
        </term>
        <term>
          <name>TRACEROUTE</name>
          <from>
            <protocol>udp</protocol>
            <destination-port>33434-33523</destination-port>
          </from>
          <then>
            <accept/>
          </then>
        </term>
        <term>
          <name>SNMP</name>
          <from>
            <source-prefix-list>
              <name>SNMP_MGRS</name>
            </source-prefix-list>
            <protocol>udp</protocol>
            <port>snmp</port>
          </from>
          <then>
            <accept/>
          </then>
        </term>
        <term>
          <name>GRE</name>
          <from>
            <source-prefix-list>
              <name>GRE_PEERS</name>
            </source-prefix-list>
            <protocol>gre</protocol>
          </from>
          <then>
            <accept/>
          </then> 
        </term>
        <term>
          <name>NTP</name>
          <from>
            <source-prefix-list>
              <name>LOOPBACK_IPS</name>
            </source-prefix-list>
            <source-prefix-list>
              <name>NTP_SERVERS</name>
            </source-prefix-list>
            <protocol>udp</protocol>
            <port>ntp</port>
          </from>
          <then>
            <accept/>
          </then>
        </term>
        <term>
          <name>VRRP</name>
          <from>
            <destination-address>
              <name>224.0.0.18/32</name>
            </destination-address>
          </from>
          <then>
            <accept/>
          </then>
        </term>
        <term>
          <name>Discard</name>
          <then>
            <count>RE_PROTECT_DISCARD</count>
            <discard>
            </discard>
          </then>
        </term>
      </filter>
    </inet>
    <inet6>
      <filter operation="replace">
        <name>V6_RE_PROTECT</name>
        <term>
          <name>BGP</name>
          <from>
            <source-prefix-list>
              <name>V6_BGP_PEERS</name>
            </source-prefix-list>
            <next-header>tcp</next-header>
            <port>bgp</port>
          </from>
          <then>
            <count>V6_RE_PROTECT_BGP</count>
            <accept/>
          </then>
	</term>
        <term>
          <name>ICMPV6</name>
          <from>
            <next-header>icmpv6</next-header>
          </from>
          <then>
            <count>V6_RE_PROTECT_ICMPV6</count>
            <accept/>
          </then>
	</term>
        <term>
          <name>TRACEROUTE</name>
          <from>
            <next-header>udp</next-header>
            <destination-port>33434-33523</destination-port>
          </from> 
          <then>
            <accept/>
          </then>
	</term>
        <term>
          <name>VRRP</name>
          <from>
            <destination-address>
              <name>ff02::12/128</name>
	    </destination-address>
	  </from>
          <then>
            <accept/>
          </then>
	</term>
        <term>
          <name>DISCARD</name>
          <then>
            <count>V6_RE_PROTECT_DISCARD</count>
            <discard>
            </discard>
          </then>
        </term>
      </filter>
      </inet6>
  </family>
</firewall>
<policy-options>
  <prefix-list operation="replace">
    <name>TRUSTED</name>
    <prefix-list-item>
      <name>192.168.0.0/16</name>
    </prefix-list-item>
    <prefix-list-item>
      <name>192.0.2.0/24</name>
    </prefix-list-item>
  </prefix-list>
  <prefix-list operation="replace">
    <name>SNMP_MGRS</name>
    <prefix-list-item>
      <name>192.0.2.1</name>
    </prefix-list-item>
    <prefix-list-item>
      <name>198.51.100.2</name>
    </prefix-list-item>
  </prefix-list>
  <prefix-list operation="replace">
    <name>DNS_SERVERS</name>
      <apply-path>system name-server &lt;*.*.*.*&gt;</apply-path>
  </prefix-list>
  <prefix-list operation="replace">
    <name>NTP_SERVERS</name>
      <apply-path>system ntp server &lt;*.*.*.*&gt;</apply-path>
  </prefix-list>
  <prefix-list operation="replace">
    <name>LOOPBACK_IPS</name>
    <prefix-list-item>
      <name>127.0.0.1</name>
    </prefix-list-item>
      <apply-path>interfaces lo0 unit &lt;*&gt; family inet address &lt;*.*.*.*&gt;</apply-path>
  </prefix-list>
  <prefix-list operation="replace">
    <name>V6_LOOPBACK-IPS</name>
      <apply-path>interfaces lo0 unit &lt;*&gt; family inet6 address &lt;*:*&gt;</apply-path>
  </prefix-list>
  <prefix-list operation="replace">
    <name>GRE_PEERS</name>
      <apply-path>interfaces &lt;*&gt; unit &lt;*&gt; tunnel destination &lt;*&gt;</apply-path>
  </prefix-list>
  <prefix-list operation="replace">
    <name>BGP_PEERS</name>
      <apply-path>routing-instances &lt;*&gt; protocols bgp group &lt;*&gt; neighbor &lt;*.*.*.*&gt;</apply-path>
  </prefix-list>
  <prefix-list operation="replace">
    <name>V6_BGP_PEERS</name>
      <apply-path>routing-instances &lt;*&gt; protocols bgp group &lt;*&gt; neighbor &lt;*:*&gt;</apply-path>
  </prefix-list>
</policy-options>
<snmp operation="replace">
  <description>edge-01</description>
  <location>123 Main St.</location>
  <contact>noc@example.com</contact>
  <v3>
    <usm>
      <local-engine>
        <user>
          <name>my_snmp_user</name>
          <authentication-sha>
            <authentication-key>my_auth_key</authentication-key>
          </authentication-sha>
          <privacy-aes128>
            <undocumented><privacy-key>my_priv_key</privacy-key></undocumented>
          </privacy-aes128>
        </user>
      </local-engine>
    </usm>
    <vacm>
      <security-to-group>
        <security-model>
          <name>usm</name>
          <security-name>
            <name>my_snmp_user</name>
            <group>all-info</group>
          </security-name>
        </security-model>
      </security-to-group>
      <access>
        <group>
          <name>all-info</name>
          <default-context-prefix>
            <security-model>
              <name>usm</name>
              <security-level>
                <name>privacy</name>
                <read-view>all-info</read-view>
              </security-level>
              <security-level>
                <name>authentication</name>
                <read-view>all-info</read-view>
              </security-level>
            </security-model>
          </default-context-prefix>
        </group>
      </access>
    </vacm>
  </v3>
  <engine-id>
   <local>aaaabbbbcccc</local>
  </engine-id>
  <view>
    <name>all-info</name>
    <oid>
      <name>.1</name>
    </oid>
  </view>                 
  <community>
    <name>my_snmp_community</name>
      <authorization>read-only</authorization>
  </community>
  <trap-group>
    <name>public</name>
    <version>v2</version>
    <categories>
      <authentication/>
      <chassis/>
      <link/>
      <remote-operations/>
      <routing/>
      <startup/>
      <rmon-alarm/>
      <configuration/>
      <services/>
      </categories>
    <targets>
      <name>192.0.2.5</name>
    </targets>
  </trap-group>
</snmp>
<system operation="replace">
  <time-zone>UTC</time-zone>
  <undocumented>
    <dump-on-panic>
    </dump-on-panic>
  </undocumented>
  <default-address-selection/>
  <saved-core-context/>
  <location>
    <country-code>US</country-code>
    <postal-code>1234</postal-code>
    <latitude>1.1111</latitude>
    <longitude>2.2222</longitude>
    <building>Acme Colocation 1</building>
  </location>
  <ports>
    <console>
      <log-out-on-disconnect/>
    </console>
    <auxiliary>
      <disable/>
    </auxiliary>
  </ports>
  <host-name>edge-01</host-name>
  <domain-name>example.com</domain-name>
  <domain-search>foo.net</domain-search>
  <domain-search>bar.net</domain-search>
  <root-authentication>
    <encrypted-password>$sha1$a2bba2d1f9e066c3d8e7c54456a28f5db508a32a</encrypted-password>
  </root-authentication>
  <name-server>
    <name>192.0.2.5</name>
  </name-server>
  <login>
    <message>
          UNAUTHORIZED ACCESS TO THIS DEVICE IS PROHIBITED.
    </message>
    <class>
      <name>L1</name>
      <idle-timeout>30</idle-timeout>
      <permissions>view</permissions>
    </class>
    <class>
      <name>L2</name>
      <idle-timeout>30</idle-timeout>
      <permissions>configure</permissions>
      <permissions>firewall-control</permissions>
      <permissions>network</permissions>
      <permissions>routing</permissions>
      <permissions>routing-control</permissions>
      <permissions>snmp</permissions>
      <permissions>system</permissions>
      <permissions>trace</permissions>
      <permissions>view</permissions>
      <permissions>view-configuration</permissions>
    </class>
    <class>
      <name>L3</name>
      <idle-timeout>60</idle-timeout>
      <permissions>all</permissions>
    </class>
    <user>
      <name>admin</name>
      <uid>5678</uid>
      <full-name>Network Admin</full-name> 
      <class>L3</class> 
      <authentication>
	<encrypted-password>$1$f9GW6OxO$LDeSSvLf2adXjGyVX0SiL/</encrypted-password>
	<ssh-rsa>
	  <name>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDgkVjgfvooKnf3rvzM7+53CrWVUnM0MH8LZmDpvULMuEmkBeax8wf37FTKbDf/farzZqt5+bMI2Wb647nRsFJvNfpVA0z0PuOl+IJDOn57ggGmVfQ0te4XKSZA7ZqTuUy4KXKfEMwG+Wbh8N+eorcfcGuGOiFuj7PUq/7tXquiFn5JWM8pabB4PjEY3QOEmQJsdi9TjNjR86MT5gx3HxIkM2OeccGbEg8itv9Ag3Rtyz55WCDRrcIpJ0okAMoeK9SLgOKDMcXNvUXZET7+g9gw7f4cY0DgnNA5IAhS/A8OO9I+cYTX3cr1b+78WMf5B1cK7iSm96pes5s+zyyphgzR admin@localhost</name>
	</ssh-rsa>
      </authentication>
    </user>
    <user>
      <name>btables</name>
      <uid>9876</uid>
      <full-name>Bobby Tables</full-name> 
      <class>L1</class> 
      <authentication>
	<encrypted-password>$1$99690840b73c55ea09398bea95ab079e85f1a350</encrypted-password>
      </authentication>
    </user>
    <user>
      <name>oper</name>
      <uid>1234</uid>
      <full-name>Network Operator</full-name> 
      <class>L2</class> 
      <authentication>
	<encrypted-password>$1$JOeZQorD$Rs1wMNhjty5TOV260bfID.</encrypted-password>
	<ssh-rsa>
	  <name>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDCd+pIH497e/YUIXWt/fBF1DHwd5wlRxJdt22+ibWZQjXSs7F8sQBuIFhhv3rPOkBMKyBLgIeg+bc+KZu6NOfT38xTdRyTzZatojaZfuUcKWjK/It8L29wP2uc1woInYsNsrrMv8ML0s49pYS6BNMqwhFomcqLhw2OSu1RqQRlK69zNymgp9SHPTT0DXhouftQTchgWOxxt58rJ+naL+zIBGGBx2kTSEf3xfi4BpR41pcRhOuRxMiZl72+aYx09UkSMPWQT2aoZY3XAPylxxAD/7P5VJESrn2qn0GZv4D5F0DwZc1mM5xWMSgECvBFv8TQMVVYDU2+LU9rOclWaGS/ oper@localhost</name>
	</ssh-rsa>
      </authentication>
    </user>
    <password>
      <format>sha1</format>
    </password>
  </login>
  <services>
    <ssh>
      <root-login>deny-password</root-login>
      <tcp-forwarding/>
      <protocol-version>v2</protocol-version>
      <ciphers>aes256-cbc</ciphers>
      <ciphers>aes192-cbc</ciphers>
      <ciphers>aes128-cbc</ciphers>
      <hostkey-algorithm>
        <ssh-dss>
        </ssh-dss>
        <ssh-rsa>
        </ssh-rsa>
        <ssh-ecdsa>
        </ssh-ecdsa>
      </hostkey-algorithm>
      <client-alive-count-max>5</client-alive-count-max>
      <client-alive-interval>10</client-alive-interval>
      <connection-limit>5</connection-limit>
      <rate-limit>5</rate-limit>
    </ssh>
    <netconf>
      <ssh>
	<connection-limit>5</connection-limit>
	<rate-limit>5</rate-limit>
      </ssh>
    </netconf>
  </services>
  <syslog>
    <archive>           
      <size>10m</size>
      <files>10</files>
    </archive>
    <user>
      <name>*</name>
      <contents>
	<name>any</name>
	<emergency/>
      </contents>
    </user>
    <host>
      <name>192.0.2.5</name>
      <contents>
	<name>any</name>
	<any/>
      </contents>
    </host>
    <file>
      <name>messages</name>
      <contents>
	<name>any</name>
	<notice/>
      </contents>
    </file>
    <file>
      <name>events.log</name>
      <contents>
        <name>authorization</name>
        <info/>
      </contents>
      <archive>
        <size>10m</size>
        <files>10</files>
        <no-world-readable/>
      </archive>
    </file>
    <file>
      <name>commands.log</name>
      <contents>
        <name>interactive-commands</name>
        <any/>
      </contents>
      <archive>
        <size>10m</size>
        <files>10</files>
        <no-world-readable/>
      </archive>
    </file>
    <file>
      <name>changes.log</name>
      <contents>
        <name>change-log</name>
        <info/>
      </contents>
      <archive>
        <size>10m</size>
        <files>10</files>
        <no-world-readable/>
      </archive>
    </file>
    <time-format>
      <year/>
      <millisecond/>
    </time-format>
  </syslog>
  <compress-configuration-files/>
  <ntp>
    <boot-server>192.0.2.5</boot-server>
    <server>
      <name>192.0.2.5</name>
    </server>
    <server>
      <name>192.0.2.1</name>
    </server>
    <server>
      <name>198.51.100.5</name>
    </server>
  </ntp>
</system>
</configuration>
